<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lembar Kerja Praktikum Fisika</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Quicksand', sans-serif; }
        /* Smooth scrolling */
        html { scroll-behavior: smooth; }
        .glass-panel {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-teal-100 via-sky-100 to-indigo-100 min-h-screen text-slate-700">

    <div id="login-section" class="fixed inset-0 z-50 flex items-center justify-center bg-white/30 backdrop-blur-md p-4">
        <div class="bg-white rounded-2xl shadow-xl p-8 w-full max-w-md border-t-4 border-teal-400">
            <div class="text-center mb-6">
                <h1 class="text-2xl font-bold text-teal-600">Selamat Datang üëã</h1>
                <p class="text-sm text-gray-500">Ujian Praktikum Fisika 2026</p>
            </div>
            <form id="login-form" class="space-y-4">
                <div>
                    <label class="block text-sm font-semibold text-gray-600 mb-1">NIS</label>
                    <input type="number" id="nis" class="w-full px-4 py-3 rounded-lg bg-gray-50 border border-gray-200 focus:ring-2 focus:ring-teal-400 focus:outline-none transition" placeholder="Masukkan NIS" required>
                </div>
                <div>
                    <label class="block text-sm font-semibold text-gray-600 mb-1">Password</label>
                    <input type="password" id="password" class="w-full px-4 py-3 rounded-lg bg-gray-50 border border-gray-200 focus:ring-2 focus:ring-teal-400 focus:outline-none transition" placeholder="Kata sandi" required>
                </div>
                <button type="submit" class="w-full bg-teal-500 hover:bg-teal-600 text-white font-bold py-3 rounded-xl shadow-lg transform active:scale-95 transition-all">
                    Mulai Praktikum
                </button>
            </form>
        </div>
    </div>

    <div id="app-section" class="hidden container mx-auto px-4 py-6 max-w-3xl">
        
        <header class="flex justify-between items-center mb-6 bg-white rounded-xl p-4 shadow-sm border-l-4 border-indigo-400">
            <div>
                <h2 class="font-bold text-lg text-indigo-900" id="student-name">Nama Siswa</h2>
                <p class="text-xs text-indigo-500 font-mono" id="student-nis">NIS: 12345</p>
            </div>
            <div class="text-right">
                <span class="bg-indigo-100 text-indigo-700 text-xs font-bold px-2 py-1 rounded-md">Kelas XII</span>
            </div>
        </header>

        <div class="text-center mb-8">
            <span class="text-xs font-bold tracking-widest text-teal-600 uppercase">Topik Praktikum</span>
            <h1 class="text-3xl font-bold text-slate-800 mt-1" id="topic-title">Loading...</h1>
        </div>

        <form id="worksheet-form" class="space-y-6">
            
            <section class="bg-white rounded-2xl shadow-sm p-5 border border-slate-100">
                <h3 class="text-lg font-bold text-teal-600 mb-3 flex items-center">
                    <span class="bg-teal-100 p-1 rounded-md mr-2">üéØ</span> Tujuan Percobaan
                </h3>
                <textarea id="tujuan" rows="3" class="w-full p-3 rounded-lg bg-slate-50 border border-slate-200 focus:ring-2 focus:ring-teal-400 outline-none text-sm" placeholder="Tuliskan tujuan percobaan sesuai pemahamanmu..."></textarea>
            </section>

            <section class="bg-white rounded-2xl shadow-sm p-5 border border-slate-100">
                <div class="flex justify-between items-center mb-3">
                    <h3 class="text-lg font-bold text-teal-600 flex items-center">
                        <span class="bg-teal-100 p-1 rounded-md mr-2">üõ†Ô∏è</span> Alat & Bahan
                    </h3>
                    <button type="button" onclick="addTool()" class="text-xs bg-teal-50 text-teal-600 px-3 py-1 rounded-full font-bold hover:bg-teal-100">+ Tambah</button>
                </div>
                <div id="tools-container" class="space-y-2">
                    <div class="flex gap-2 tool-item">
                        <input type="text" class="tool-input flex-1 p-2 rounded-lg bg-slate-50 border border-slate-200 text-sm focus:outline-none focus:border-teal-400" placeholder="Nama alat/bahan">
                        <button type="button" onclick="this.parentElement.remove()" class="text-red-400 hover:text-red-600 p-2">‚úï</button>
                    </div>
                </div>
            </section>

            <section class="bg-white rounded-2xl shadow-sm p-5 border border-slate-100 overflow-hidden">
                <h3 class="text-lg font-bold text-teal-600 mb-3 flex items-center">
                    <span class="bg-teal-100 p-1 rounded-md mr-2">üìä</span> Data Pengamatan
                </h3>
                
                <div class="bg-blue-50 text-blue-700 text-xs p-3 rounded-lg mb-4">
                    üí° Gunakan tanda titik (.) untuk angka desimal. Contoh: 9.81
                </div>

                <div class="overflow-x-auto">
                    <table class="w-full text-sm text-left text-gray-500">
                        <thead class="text-xs text-gray-700 uppercase bg-gray-50">
                            <tr id="table-header">
                                </tr>
                        </thead>
                        <tbody id="table-body">
                            </tbody>
                    </table>
                </div>
            </section>

            <section class="bg-white rounded-2xl shadow-sm p-5 border border-slate-100">
                <h3 class="text-lg font-bold text-teal-600 mb-3 flex items-center">
                    <span class="bg-teal-100 p-1 rounded-md mr-2">üß†</span> Analisis Data
                </h3>
                <div id="analysis-questions" class="space-y-4">
                    </div>
            </section>

            <section class="bg-white rounded-2xl shadow-sm p-5 border border-slate-100">
                <h3 class="text-lg font-bold text-teal-600 mb-3 flex items-center">
                    <span class="bg-teal-100 p-1 rounded-md mr-2">üìù</span> Kesimpulan
                </h3>
                <textarea id="kesimpulan" rows="4" class="w-full p-3 rounded-lg bg-slate-50 border border-slate-200 focus:ring-2 focus:ring-teal-400 outline-none text-sm" placeholder="Apa yang dapat kamu simpulkan dari percobaan ini?"></textarea>
            </section>

            <div class="fixed bottom-0 left-0 right-0 p-4 bg-white/80 backdrop-blur-md border-t border-gray-200 flex gap-3 z-40">
                <button type="button" onclick="saveLocal()" class="flex-1 bg-white border border-teal-500 text-teal-600 font-bold py-3 rounded-xl shadow-sm hover:bg-teal-50 transition">
                    üíæ Simpan di HP
                </button>
                <button type="button" onclick="uploadData()" class="flex-1 bg-gradient-to-r from-teal-500 to-emerald-500 text-white font-bold py-3 rounded-xl shadow-lg shadow-teal-500/30 active:scale-95 transition">
                    üöÄ Upload Data
                </button>
            </div>
            <div class="h-20"></div>
        </form>
    </div>

    <script>
        // --- DATA KONFIGURASI SOAL (Dari PDF Anda) ---
        const PRACTICUMS = {
            'hooke': {
                title: 'Hukum Hooke',
                headers: ['No', 'Massa (kg)', 'Gaya (N)', 'Panjang Akhir (m)', '‚àÜx (m)', 'k (N/m)'],
                rows: 5,
                questions: [
                    "Bagaimana hubungan antara gaya (F) dan pertambahan panjang (‚àÜx)?",
                    "Apa yang terjadi jika pegas ditarik melebihi batas elastisitasnya?",
                    "Jika k = 200 N/m dan F = 10 N, hitung ‚àÜx!"
                ]
            },
            'pendulum': {
                title: 'Bandul Sederhana',
                headers: ['No', 'Panjang Tali (m)', 'Waktu 10 Osilasi (s)', 'Periode (T)', 'g (m/s¬≤)'],
                rows: 5,
                questions: [
                    "Bagaimana hubungan panjang tali dengan periode osilasi?",
                    "Mengapa sudut simpangan harus kecil (<10¬∞)?",
                    "Bandingkan hasil 'g' hitunganmu dengan 9.81 m/s¬≤. Jelaskan jika ada selisih."
                ]
            }
        };

        // --- STATE MANAGEMENT ---
        let currentTopic = '';
        const savedDataKey = 'uprak_fisika_mr_alfi_v1';

        // 1. Logic Login & Randomizer (Simulasi)
        document.getElementById('login-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const nis = document.getElementById('nis').value;
            
            // SIMULASI: Di real app, ini akan cek ke Google Sheet
            // Logika acak sederhana berdasarkan digit terakhir NIS:
            // Ganjil = Hooke, Genap = Bandul (Bisa diubah nanti agar seimbang per kelas)
            const topicKey = (parseInt(nis) % 2 !== 0) ? 'hooke' : 'pendulum'; 
            
            loadPracticum(topicKey, nis);
        });

        // 2. Load Halaman Praktikum
        function loadPracticum(topic, nis) {
            currentTopic = topic;
            const config = PRACTICUMS[topic];

            // Hide Login, Show App
            document.getElementById('login-section').classList.add('hidden');
            document.getElementById('app-section').classList.remove('hidden');

            // Set Header Info
            document.getElementById('student-nis').textContent = `NIS: ${nis}`;
            document.getElementById('student-name').textContent = "Siswa " + nis; // Nanti ambil dari DB
            document.getElementById('topic-title').textContent = config.title;

            // Render Table
            const thead = document.getElementById('table-header');
            thead.innerHTML = config.headers.map(h => `<th class="px-4 py-3 bg-gray-100 border-b">${h}</th>`).join('');
            
            const tbody = document.getElementById('table-body');
            tbody.innerHTML = '';
            for(let i=1; i<=config.rows; i++) {
                let rowHtml = `<tr class="bg-white border-b hover:bg-gray-50"><td class="px-4 py-2 font-medium text-gray-900">${i}</td>`;
                // Buat input cell sebanyak kolom header - 1 (karena kolom No sudah ada)
                for(let j=0; j<config.headers.length-1; j++) {
                    // Validasi input decimal
                    rowHtml += `<td class="p-1"><input type="text" inputmode="decimal" class="w-full bg-transparent border-b border-dashed border-gray-300 focus:border-teal-500 focus:ring-0 text-center py-2 text-slate-700" oninput="validateDecimal(this)"></td>`;
                }
                rowHtml += `</tr>`;
                tbody.insertAdjacentHTML('beforeend', rowHtml);
            }

            // Render Questions
            const qContainer = document.getElementById('analysis-questions');
            qContainer.innerHTML = config.questions.map((q, idx) => `
                <div class="mb-4">
                    <label class="block text-sm font-medium text-gray-700 mb-2">${idx+1}. ${q}</label>
                    <textarea class="w-full p-3 rounded-lg bg-slate-50 border border-slate-200 focus:ring-2 focus:ring-teal-400 outline-none text-sm" rows="2"></textarea>
                </div>
            `).join('');

            // Cek apakah ada data tersimpan di LocalStorage
            loadLocal();
        }

        // 3. Fitur Tambah Alat
        function addTool(value = '') {
            const container = document.getElementById('tools-container');
            const div = document.createElement('div');
            div.className = 'flex gap-2 tool-item animate-fade-in';
            div.innerHTML = `
                <input type="text" value="${value}" class="tool-input flex-1 p-2 rounded-lg bg-slate-50 border border-slate-200 text-sm focus:outline-none focus:border-teal-400" placeholder="Nama alat/bahan">
                <button type="button" onclick="this.parentElement.remove()" class="text-red-400 hover:text-red-600 p-2">‚úï</button>
            `;
            container.appendChild(div);
        }

        // 4. Validasi Desimal (Ganti koma jadi titik)
        function validateDecimal(input) {
            input.value = input.value.replace(/,/g, '.').replace(/[^0-9.]/g, '');
        }

        // 5. Simpan Lokal (LocalStorage)
        function saveLocal() {
            const data = collectData();
            localStorage.setItem(savedDataKey, JSON.stringify(data));
            
            // Visual feedback
            const btn = document.querySelector('button[onclick="saveLocal()"]');
            const originalText = btn.innerHTML;
            btn.innerHTML = "‚úÖ Tersimpan!";
            setTimeout(() => btn.innerHTML = originalText, 2000);
        }

        function loadLocal() {
            const raw = localStorage.getItem(savedDataKey);
            if(!raw) {
                addTool('Statif'); // Default tool
                return;
            };

            const data = JSON.parse(raw);
            if(data.topic !== currentTopic) return; // Jangan load jika topik beda (misal ganti siswa di HP sama)

            document.getElementById('tujuan').value = data.tujuan || '';
            document.getElementById('kesimpulan').value = data.kesimpulan || '';
            
            // Restore Tools
            document.getElementById('tools-container').innerHTML = '';
            data.tools.forEach(t => addTool(t));

            // Restore Table Inputs
            const inputs = document.querySelectorAll('#table-body input');
            data.tableData.forEach((val, idx) => {
                if(inputs[idx]) inputs[idx].value = val;
            });

            // Restore Answers
            const textareas = document.querySelectorAll('#analysis-questions textarea');
            data.answers.forEach((val, idx) => {
                if(textareas[idx]) textareas[idx].value = val;
            });
        }

        // Helper: Collect all data from form
        function collectData() {
            const tools = Array.from(document.querySelectorAll('.tool-input')).map(i => i.value);
            const tableData = Array.from(document.querySelectorAll('#table-body input')).map(i => i.value);
            const answers = Array.from(document.querySelectorAll('#analysis-questions textarea')).map(i => i.value);
            
            return {
                nis: document.getElementById('student-nis').textContent,
                topic: currentTopic,
                tujuan: document.getElementById('tujuan').value,
                tools: tools,
                tableData: tableData,
                answers: answers,
                kesimpulan: document.getElementById('kesimpulan').value,
                timestamp: new Date().toISOString()
            };
        }

        // 6. Upload Data (Placeholder)
        function uploadData() {
            const data = collectData();
            if(!confirm("Yakin ingin mengumpulkan data? Pastikan data sudah benar.")) return;

            // TODO: Integrasi dengan Google Apps Script (doPost)
            console.log("Data to send:", data);
            
            alert("Simulasi: Data berhasil dikirim ke Server! \n(Nanti ini akan masuk Google Sheet)");
            localStorage.removeItem(savedDataKey); // Clear local setelah upload
        }
    </script>
</body>
</html>